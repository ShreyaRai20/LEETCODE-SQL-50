
SELECT Q1.person_name
FROM QUEUE Q1 JOIN QUEUE Q2 ON Q1.TURN >= Q2.TURN
GROUP BY Q1.TURN
HAVING SUM(Q2.WEIGHT)<= 1000
ORDER BY SUM(Q2.WEIGHT) DESC
LIMIT 1;
